<div class="chart-container">
    <!-- *ngIf="addBtn;" -->
    <!-- <div class="example-button-container" style="text-align: center; margin-left: -280px;" (click)="onNodeSelect('Trigger')">

        <button mat-fab color="primary" *ngIf="addBtn;" aria-label="Example icon button with a delete icon">
            <mat-icon>add</mat-icon>
        </button>
    </div> -->
    <ngx-graph [view]="[1500, 700]" [links]="links" [panToNode$]="panToNode$" [center$]="center$"
        [layoutSettings]="layoutSettings" [nodes]="nodes" layout="dagre" [enableZoom]="true" [animate]="false"
        [autoCenter]="true" style="margin-top: -550px;">

        <ng-template #defsTemplate>
            <svg:marker id="arrow" viewBox="0 -5 10 10" refX="8" refY="0" markerWidth="4" markerHeight="4"
                orient="auto">
                <svg:path d="M0,-5L10,0L0,5" class="arrow-head" />
            </svg:marker>

        </ng-template>
        <!-- Define the templates for nodes and links -->
        <ng-template #nodeTemplate let-node>
            <svg:g class="node" (click)="event($event)" [attr.transform]="'translate(' + 100 + ', ' + 10 + ')'">

                <!--   -->
                <svg:line *ngIf="isDragging && draggedLine" [attr.x1]="draggedLine.x1" [attr.y1]="draggedLine.y1"
                    [attr.x2]="draggedLine.x2" [attr.y2]="draggedLine.y2"
                    [attr.stroke]="isDragging && draggedLine ? 'red' : 'black'" [attr.stroke-width]="2"></svg:line>
                <!-- Add line arrow -->
                <svg:line *ngIf="node.label !== 'Condition'" x1="0" y1="225" x2="0" y2="180"
                    [attr.stroke]="isDragging && draggedLine === node ? 'red' : 'black'" [attr.stroke-width]="2"
                    [attr.pointer-events]="isDragging ? 'none' : 'auto'">
                </svg:line>
                <!-- <svg:polygon *ngIf=" node.label !=='Condition'" points=" -5,75 0,85 5,75" fill="black">
                </svg:polygon> -->
                <svg:line *ngIf="node.label === 'Condition'" [attr.disabled]="node.disabledYes"
                    [ngClass]="{ 'disabled-line': node.disabledYes}" x1="-75" y1="225" x2="-75" y2="180" stroke="black"
                    stroke-width="2"></svg:line>

                <!-- <svg:polygon *ngIf="node.label === 'Condition'" points="-5,75 0,85 5,75" fill="black"></svg:polygon> -->
                <svg:line *ngIf="node.label === 'Condition'" x1="75" y1="225" x2="75" y2="180" stroke="black"
                    stroke-width="2" [attr.disabled]="node.disabledNo" [ngClass]="{ 'disabled-line': node.disabledNo }">
                </svg:line>
                <!-- <svg:polygon *ngIf="node.label === 'Condition'" points="-5,75 0,85 5,75" fill="black"></svg:polygon> -->

                <foreignObject x="-150" y="30" style="
                /* border: 1px solid gray; */
                box-shadow: 0 0 2px 2px #ccc;
                height: 150px;
                border-radius: 10px;
                display: flex;
                " width="300" height="100" class="content">
                    <!-- (click)="deleteNode(node)" -->
                    <mat-icon *ngIf="node.label!=='Trigger' " (click)="deleteNode(node,$event)"
                        style="padding-left: 270px;margin-top: 10px; font-size: 20px;color: rgb(240, 159, 8);">delete_outline</mat-icon>
                    <div *ngIf="node.label==='Trigger' " (click)="addSchema(node,$event)"
                        style="text-align: center; background-color: white; margin-top: 45px;">
                        <!-- <p>{{node.label}}</p> -->
                        <!-- <button (click)="addPath(node)" mat-fab color="primary"
                            aria-label="Example icon button with a delete icon"> -->
                        <div class="trigger.data" style="line-height: 0px; font-family: sans-serif;">
                            <!-- {{actionData.trigger}} -->
                            <p style="font-size: 20px; font-weight: 500px; line-height: 0px; margin-bottom: 25px;">
                                People Enter When</p>
                            <h4>They Sign up</h4>
                            <p style="    padding-top: 8px;
                            font-size: 20px;
                            font-weight: bold;">8,046</p>
                            <p style="padding-top: 5px;
                            font-size: 18px;">Entered</p>

                        </div>
                        <!-- </button> -->
                    </div>
                    <div *ngIf=" node.label ==='Action' || node.label === 'Condition' || node.label === 'Delay'"
                        (click)="addSchema(node,$event)"
                        style="text-align: center; background-color: white; margin-top: 20px;">
                        <!-- <p>{{node.label}}</p> -->
                        <div *ngIf="node.label === 'Action'">
                            <div style="line-height: 0px; font-family: sans-serif;">
                                <p>Do they Match this condition?</p>
                                <h5 style="margin-bottom: 0px; font-size: 15px;">Are they active user?</h5>
                                <div style="display: flex; justify-content: space-around;">
                                    <div>
                                        <h6 style="    font-size: 20px;
                            line-height: 0px;
                            margin-top: 30px;
                            margin-bottom: 20px;
                            padding: 3px;">2,735</h6>
                                        <p>Yes</p>
                                    </div>
                                    <div>
                                        <h6 style="    font-size: 20px;
                            line-height: 0px;
                            margin-top: 30px;
                            margin-bottom: 20px;
                            padding: 3px;">5,311</h6>
                                        <p>No</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div *ngIf="node.label === 'Condition'" class="condition-data" style="font-family: sans-serif; line-height: 0px;">
                            <h5 class="mails">Sent Mail <span class="span-tag">or</span> SMS</h5>
                            <div class="mails-data">
                              <div>
                                <h6 style="font-size: 15px;margin-bottom: 20px; ">Sent Mails</h6>
                                 <p style="font-weight: bold; font-size: 15px;">3,450</p>
                              </div>
                              <div>
                                <h6 style="font-size: 15px;margin-bottom: 20px; ">Sent SMS</h6>
                                 <p style="font-weight: bold; font-size: 15px;">3,450</p>
                              </div>
                              <div>
                                <h6 style="font-size: 15px;margin-bottom: 20px; "> Rej Mails/SMS</h6>
                                 <p style="font-weight: bold; font-size: 15px;">3,450</p>
                              </div>
                            </div>                    
                        </div>
                        <div *ngIf="node.label === 'Delay'" style="font-family: sans-serif; margin-top: px;">
                            <p style="font-size: 15px; margin-bottom: -25px;">Time to delay of Duration in Mail <span class="span-tag">or</span> SMS </p>
                            <div class="data-duration">
                                <div>
                                  <h6 style="font-size: 15px;margin-bottom: -10px; ">Hours</h6>
                                   <p style="font-weight: bold; font-size: 15px;">24 hrs</p>
                                </div>
                                <div>
                                  <h6 style="font-size: 15px;margin-bottom: -10px; ">Minutes</h6>
                                   <p style="font-weight: bold; font-size: 15px;">60 Min</p>
                                </div>
                                <div>
                                  <h6 style="font-size: 15px;margin-bottom: -10px; "> Seconds</h6>
                                   <p style="font-weight: bold; font-size: 15px;">60 Sec</p>
                                </div>
                              </div>                    
                          
                        
            
                          
                        </div>
                        <!-- <button (click)="addPath(node)" mat-fab color="primary"
                                                                    aria-label="Example icon button with a delete icon"> -->

                        <!-- </button> -->
                        <!-- <div *ngFor="let data of actionData.nodes">
                            <p *ngIf="node.label === 'Action'">{{ data?.action?.targetType }}</p>
                            <h1>hello world</h1>

                        </div>
                        <div *ngFor="let data of actionData.nodes">
                            <div *ngFor="let data1 of data.conditions">
                                <p *ngIf="node.label === 'Condition'">{{ data1.condition }}</p>
                            </div>

                        </div>
                        <div *ngFor="let data of actionData.nodes">
                            <p *ngIf="node.label === 'Delay'">{{ data?.duration ? data?.duration +' ' + 'Ms' : '' }}
                            </p>
                        </div> -->
                    </div>
                </foreignObject>
                <!-- <svg:circle [attr.r]="30" [attr.fill]="node.color"></svg:circle> -->
                <svg:foreignObject x="-30" y="-5" width="80" height="80">
                    <div class="end-icon-button">
                        <!-- <button (click)="addPath(node)" mat-fab color="primary"
                            aria-label="Example icon button with a delete icon">
                            <mat-icon>add</mat-icon>
                        </button> -->
                        <img src="{{node.icon}}" alt="Add" style="cursor: pointer;width: 60px;height: 60px;">

                    </div>
                </svg:foreignObject>
                <!-- Icon button at the end of the line -->
                <svg:foreignObject *ngIf="node.label !== 'Condition'" x="-28" y="225" width="60" height="60">
                    <div class="end-icon-button">
                        <button mat-fab color="primary" aria-label="Example icon button with a delete icon">
                            <mat-icon (click)="addPath(node)" *ngIf="!node.disabledNode">add</mat-icon>
                        </button>
                    </div>
                </svg:foreignObject>
                <svg:foreignObject *ngIf="node.label === 'Condition' " x="-100" y="225" width="60" height="60">
                    <div class="end-icon-button">
                        <button mat-fab color="primary" aria-label="Example icon button with a delete icon">
                            <mat-icon (click)="createYesNode(node,'Yes')" *ngIf="!node.disabledYes">add</mat-icon>
                        </button>
                    </div>
                </svg:foreignObject>
                <svg:foreignObject *ngIf="node.label === 'Condition' " x="50" y="225" width="60" height="60">
                    <div class="end-icon-button">
                        <button mat-fab color="primary" aria-label="Example icon button with a delete icon">
                            <mat-icon (click)="createYesNode(node,'No')" *ngIf="!node.disabledNo">add</mat-icon>
                        </button>
                    </div>
                </svg:foreignObject>
                <!-- <svg:foreignObject x="-40" y="-40" width="80" height="80">
                    <div class="delete-node-button">
                        <button (click)="deleteNode(node)" mat-icon-button color="warn" aria-label="Delete Node">
                            <mat-icon>delete</mat-icon>
                        </button>
                    </div>
                </svg:foreignObject> -->
            </svg:g>

            <!-- <div class="center-node-icon">
                <button mat-icon-button color="primary" aria-label="Center Node">
                    <mat-icon>add</mat-icon>
                </button>
            </div> -->
        </ng-template>

        <ng-template #linkTemplate let-link>
            <svg:g class="edge">
                <svg:path class="line" stroke-width="2" [attr.stroke]="'#888888'" [attr.marker-end]="'url(#arrow)'">
                </svg:path>
                <svg:text class="edge-label" text-anchor="middle">
                    <textPath class="text-path" [attr.href]="'#' + link.id" startOffset="50%">
                        {{ link.label }}
                    </textPath>
                </svg:text>
            </svg:g>

        </ng-template>

    </ngx-graph>
</div>